{"filter":false,"title":"index.js","tooltip":"/index.js","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":1699,"column":12},"end":{"row":1699,"column":13},"action":"insert","lines":["\\"],"id":2}],[{"start":{"row":1699,"column":12},"end":{"row":1699,"column":13},"action":"remove","lines":["\\"],"id":3},{"start":{"row":1699,"column":11},"end":{"row":1699,"column":12},"action":"remove","lines":["3"]},{"start":{"row":1699,"column":10},"end":{"row":1699,"column":11},"action":"remove","lines":["("]}],[{"start":{"row":1699,"column":10},"end":{"row":1699,"column":11},"action":"remove","lines":["0"],"id":4},{"start":{"row":1699,"column":10},"end":{"row":1699,"column":11},"action":"remove","lines":["0"]}],[{"start":{"row":1699,"column":10},"end":{"row":1699,"column":11},"action":"insert","lines":["("],"id":5},{"start":{"row":1699,"column":11},"end":{"row":1699,"column":12},"action":"insert","lines":["8"]},{"start":{"row":1699,"column":12},"end":{"row":1699,"column":13},"action":"insert","lines":["0"]},{"start":{"row":1699,"column":13},"end":{"row":1699,"column":14},"action":"insert","lines":["8"]}],[{"start":{"row":7,"column":0},"end":{"row":8,"column":0},"action":"insert","lines":["const { table } = require('console');",""],"id":6,"ignore":true},{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"remove","lines":["var syukkas = \"\"",""]},{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"remove","lines":["var cuss = \"\"",""]},{"start":{"row":40,"column":4},"end":{"row":40,"column":8},"action":"remove","lines":["rate"]},{"start":{"row":40,"column":4},"end":{"row":40,"column":7},"action":"insert","lines":["loc"]},{"start":{"row":41,"column":0},"end":{"row":42,"column":0},"action":"remove","lines":["",""]},{"start":{"row":51,"column":8},"end":{"row":51,"column":10},"action":"remove","lines":["  "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":2},"action":"remove","lines":["  "]},{"start":{"row":53,"column":8},"end":{"row":53,"column":10},"action":"remove","lines":["  "]},{"start":{"row":54,"column":10},"end":{"row":54,"column":11},"action":"remove","lines":[" "]},{"start":{"row":54,"column":10},"end":{"row":54,"column":11},"action":"remove","lines":[" "]},{"start":{"row":55,"column":0},"end":{"row":55,"column":2},"action":"remove","lines":["  "]},{"start":{"row":55,"column":35},"end":{"row":55,"column":44},"action":"remove","lines":["DISTINCT "]},{"start":{"row":56,"column":12},"end":{"row":60,"column":6},"action":"remove","lines":["  connection.query('SELECT DISTINCT * FROM SHOHIN LEFT OUTER JOIN PRODUCTITEM on SHOHIN.shohincode = PRODUCTITEM.productcode LEFT OUTER JOIN DESCRIPTION on SHOHIN.shohincode = DESCRIPTION.productcode ORDER BY shohincode ',function(err1,shostr){","                connection.query('SELECT * FROM PURCHASETABLE',function(err3,purchaseslipstr){","                  connection.query('SELECT * FROM SYUKKA',function(err4,syukkastr){","                    connection.query('SELECT * FROM RATE',function(err5,ratestr){","      "]},{"start":{"row":56,"column":12},"end":{"row":57,"column":0},"action":"insert","lines":["connection.query('SELECT * FROM PURCHASETABLE',function(err3,purchaseslipstr){",""]},{"start":{"row":58,"column":18},"end":{"row":58,"column":24},"action":"remove","lines":["      "]},{"start":{"row":58,"column":50},"end":{"row":58,"column":59},"action":"remove","lines":["tokuisaki"]},{"start":{"row":58,"column":50},"end":{"row":58,"column":55},"action":"insert","lines":["SALES"]},{"start":{"row":58,"column":69},"end":{"row":59,"column":6},"action":"remove","lines":["7,cusstr){","      "]},{"start":{"row":58,"column":69},"end":{"row":59,"column":0},"action":"insert","lines":["8,salestr){",""]},{"start":{"row":59,"column":52},"end":{"row":59,"column":57},"action":"remove","lines":["SALES"]},{"start":{"row":59,"column":52},"end":{"row":59,"column":67},"action":"insert","lines":["PURCHASESUMMARY"]},{"start":{"row":59,"column":81},"end":{"row":59,"column":87},"action":"remove","lines":["8,sale"]},{"start":{"row":59,"column":81},"end":{"row":59,"column":89},"action":"insert","lines":["9,pursum"]},{"start":{"row":59,"column":94},"end":{"row":60,"column":0},"action":"remove","lines":["",""]},{"start":{"row":59,"column":96},"end":{"row":59,"column":100},"action":"remove","lines":["    "]},{"start":{"row":59,"column":96},"end":{"row":60,"column":0},"action":"insert","lines":["",""]},{"start":{"row":60,"column":54},"end":{"row":62,"column":4},"action":"remove","lines":["PURCHASESUMMARY',function(err9,pursumstr){                            ","                              sales = salestr","    "]},{"start":{"row":60,"column":54},"end":{"row":61,"column":37},"action":"insert","lines":["LOCATION',(err7,locstr) => {","                        locs = locstr"]},{"start":{"row":61,"column":63},"end":{"row":61,"column":82},"action":"remove","lines":["pursums = pursumstr"]},{"start":{"row":62,"column":24},"end":{"row":62,"column":40},"action":"remove","lines":["      cuss = cus"]},{"start":{"row":62,"column":24},"end":{"row":62,"column":36},"action":"insert","lines":["sales = sale"]},{"start":{"row":63,"column":24},"end":{"row":64,"column":6},"action":"remove","lines":["      rates = ratestr[ratestr.length-1].rate","      "]},{"start":{"row":63,"column":24},"end":{"row":64,"column":0},"action":"insert","lines":["pursums = pursumstr",""]},{"start":{"row":65,"column":24},"end":{"row":65,"column":25},"action":"remove","lines":[" "]},{"start":{"row":65,"column":24},"end":{"row":65,"column":29},"action":"remove","lines":["     "]},{"start":{"row":66,"column":24},"end":{"row":71,"column":26},"action":"remove","lines":["      shos = shostr","                              syukkas = syukkastr","                              workers = workerstr","                            })","                          })","                        })"]},{"start":{"row":66,"column":24},"end":{"row":66,"column":43},"action":"insert","lines":["workers = workerstr"]},{"start":{"row":90,"column":0},"end":{"row":92,"column":2},"action":"insert","lines":["  connection.query('SELECT * FROM tokuisaki',(err,cuss)=>{","    if(err) throw err","  "]},{"start":{"row":93,"column":0},"end":{"row":94,"column":0},"action":"insert","lines":["  })",""]},{"start":{"row":418,"column":0},"end":{"row":419,"column":2},"action":"insert","lines":["  connection.query('SELECT * FROM DESCRIPTION LEFT OUTER JOIN SHOHIN on SHOHIN.shohincode = DESCRIPTION.productcode',(err,result) => {","  "]},{"start":{"row":419,"column":114},"end":{"row":419,"column":118},"action":"remove","lines":["shos"]},{"start":{"row":419,"column":114},"end":{"row":420,"column":2},"action":"insert","lines":["result})","  "]},{"start":{"row":496,"column":2},"end":{"row":498,"column":0},"action":"remove","lines":["connection.query('SELECT * FROM DIRECTDELIVERY ORDER BY directdeliverycode', (err, result) => {","    if(err) throw err",""]},{"start":{"row":496,"column":2},"end":{"row":513,"column":2},"action":"insert","lines":["tablecnt = 1","  var employee = 250","  connection.query('SELECT COUNT(*) AS cnt FROM DIRECTDELIVERY',(err,cnt)=>{","    connection.query('SELECT * FROM DIRECTDELIVERY ORDER BY directdeliverycode LIMIT 250 OFFSET ' + (employee - 250),(err,delis)=>{","      var last = Math.floor((cnt[0].cnt+250)/250)","      res.render('tyokusoutable',{title:'直送先一覧',midasi1:'直送先コード',midasi2:'直送先名',midasi3:'郵便番号',midasi4:'直送先住所',midasi5:'TEL',list:delis,tablecnt:tablecnt,last:last})","    })","  })","})","//* 直送先一覧ページ移動 *//","app.post('/tyokusoutable', (req,res) => {","  var num = Number(req.body.tablecnt)","  var employee = 250 * num","  tablecnt = num","  connection.query('SELECT COUNT(*) AS cnt FROM DIRECTDELIVERY',(err,cnt)=>{","    connection.query('SELECT * FROM DIRECTDELIVERY ORDER BY directdeliverycode LIMIT 250 OFFSET ' + (employee - 250),(err,delis)=>{","      var last = Math.floor((cnt[0].cnt+250)/250)","  "]},{"start":{"row":513,"column":130},"end":{"row":513,"column":136},"action":"remove","lines":["result"]},{"start":{"row":513,"column":130},"end":{"row":514,"column":4},"action":"insert","lines":["delis,tablecnt:tablecnt,last:last})","    "]},{"start":{"row":519,"column":97},"end":{"row":519,"column":98},"action":"remove","lines":["2"]},{"start":{"row":519,"column":97},"end":{"row":519,"column":98},"action":"insert","lines":["1"]},{"start":{"row":524,"column":139},"end":{"row":524,"column":155},"action":"insert","lines":[",tablecnt:'none'"]},{"start":{"row":527,"column":136},"end":{"row":527,"column":152},"action":"insert","lines":[",tablecnt:'none'"]},{"start":{"row":706,"column":0},"end":{"row":711,"column":4},"action":"insert","lines":["  tablecnt = 1","  var employee = 250","  connection.query('SELECT COUNT(*) AS cnt FROM SHOHIN',(err,cnt)=>{","    connection.query('SELECT * FROM SHOHIN LIMIT 250 OFFSET ' + (employee - 250),(err,shos)=>{","      var last = Math.floor((cnt[0].cnt+250)/250)","    "]},{"start":{"row":711,"column":85},"end":{"row":713,"column":2},"action":"insert","lines":[",tablecnt:tablecnt,last:last})","    })","  "]},{"start":{"row":715,"column":8},"end":{"row":715,"column":13},"action":"remove","lines":["商品名検索"]},{"start":{"row":715,"column":8},"end":{"row":715,"column":13},"action":"insert","lines":["ページ移動"]},{"start":{"row":716,"column":23},"end":{"row":716,"column":24},"action":"remove","lines":["1"]},{"start":{"row":717,"column":2},"end":{"row":717,"column":109},"action":"remove","lines":["connection.query('SELECT * FROM SHOHIN WHERE shohinname LIKE \"%' + req.body.koumoku1 + '%\"', (err, result) "]},{"start":{"row":717,"column":2},"end":{"row":721,"column":91},"action":"insert","lines":["var num = Number(req.body.tablecnt)","  var employee = 250 * num","  tablecnt = num","  connection.query('SELECT COUNT(*) AS cnt FROM SHOHIN',(err,cnt)=>{","    connection.query('SELECT * FROM SHOHIN LIMIT 250 OFFSET ' + (employee - 250),(err,shos)"]},{"start":{"row":721,"column":93},"end":{"row":721,"column":94},"action":"remove","lines":[" "]},{"start":{"row":722,"column":4},"end":{"row":723,"column":0},"action":"remove","lines":["if(err) throw err",""]},{"start":{"row":722,"column":4},"end":{"row":723,"column":2},"action":"insert","lines":["  var last = Math.floor((cnt[0].cnt+250)/250)","  "]},{"start":{"row":723,"column":81},"end":{"row":723,"column":87},"action":"remove","lines":["result"]},{"start":{"row":723,"column":81},"end":{"row":724,"column":4},"action":"insert","lines":["shos,tablecnt:tablecnt,last:last})","    "]},{"start":{"row":727,"column":10},"end":{"row":727,"column":12},"action":"insert","lines":["名・"]},{"start":{"row":728,"column":23},"end":{"row":728,"column":24},"action":"remove","lines":["2"]},{"start":{"row":728,"column":23},"end":{"row":728,"column":24},"action":"insert","lines":["1"]},{"start":{"row":729,"column":81},"end":{"row":729,"column":82},"action":"remove","lines":["2"]},{"start":{"row":729,"column":81},"end":{"row":729,"column":82},"action":"insert","lines":["1"]},{"start":{"row":731,"column":4},"end":{"row":731,"column":87},"action":"remove","lines":["res.render('producttable',{title:'商品一覧',midasi1:'商品コード',midasi2:'商品名',list:result})"]},{"start":{"row":731,"column":4},"end":{"row":738,"column":5},"action":"insert","lines":["if(result == ''){","      connection.query('SELECT * FROM SHOHIN WHERE shohinname LIKE \"%' + req.body.koumoku1 + '%\"', (err1, result1) => {","        if(err1) throw err","        res.render('producttable',{title:'商品一覧',midasi1:'商品コード',midasi2:'商品名',list:result1,tablecnt:'none'})","      })","    } else {","      res.render('producttable',{title:'商品一覧',midasi1:'商品コード',midasi2:'商品名',list:result,tablecnt:'none'})","    }"]},{"start":{"row":828,"column":18},"end":{"row":828,"column":25},"action":"insert","lines":["company"]},{"start":{"row":1264,"column":0},"end":{"row":1268,"column":4},"action":"insert","lines":["  connection.query('SELECT * FROM SYUKKA',(err,syukkas) => {","    if(err) throw err","    connection.query('SELECT * FROM SHOHIN',(err4,shos) => {","      if(err4) throw err4","    "]},{"start":{"row":1269,"column":4},"end":{"row":1269,"column":7},"action":"insert","lines":["   "]},{"start":{"row":1269,"column":7},"end":{"row":1269,"column":8},"action":"insert","lines":[" "]},{"start":{"row":1270,"column":0},"end":{"row":1270,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1271,"column":4},"end":{"row":1272,"column":0},"action":"remove","lines":["console.log(re3)",""]},{"start":{"row":1272,"column":4},"end":{"row":1272,"column":5},"action":"insert","lines":[" "]},{"start":{"row":1272,"column":5},"end":{"row":1272,"column":8},"action":"insert","lines":["   "]},{"start":{"row":1273,"column":0},"end":{"row":1273,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1274,"column":4},"end":{"row":1274,"column":5},"action":"insert","lines":[" "]},{"start":{"row":1274,"column":5},"end":{"row":1274,"column":8},"action":"insert","lines":["   "]},{"start":{"row":1274,"column":106},"end":{"row":1274,"column":107},"action":"insert","lines":["1"]},{"start":{"row":1275,"column":0},"end":{"row":1276,"column":4},"action":"insert","lines":["          if(err1) throw err1","    "]},{"start":{"row":1276,"column":102},"end":{"row":1276,"column":103},"action":"insert","lines":["2"]},{"start":{"row":1277,"column":0},"end":{"row":1278,"column":4},"action":"insert","lines":["            if(err2) throw err2","    "]},{"start":{"row":1278,"column":114},"end":{"row":1278,"column":115},"action":"insert","lines":["3"]},{"start":{"row":1279,"column":0},"end":{"row":1280,"column":4},"action":"insert","lines":["              if(err3) throw err3","    "]},{"start":{"row":1281,"column":10},"end":{"row":1281,"column":11},"action":"insert","lines":[" "]},{"start":{"row":1281,"column":11},"end":{"row":1281,"column":14},"action":"insert","lines":["   "]},{"start":{"row":1282,"column":0},"end":{"row":1282,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1283,"column":12},"end":{"row":1283,"column":13},"action":"insert","lines":[" "]},{"start":{"row":1283,"column":13},"end":{"row":1283,"column":16},"action":"insert","lines":["   "]},{"start":{"row":1284,"column":0},"end":{"row":1284,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1285,"column":12},"end":{"row":1285,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1286,"column":0},"end":{"row":1286,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1287,"column":12},"end":{"row":1288,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1287,"column":12},"end":{"row":1288,"column":3},"action":"insert","lines":["    }","   "]},{"start":{"row":1288,"column":13},"end":{"row":1288,"column":14},"action":"insert","lines":[" "]},{"start":{"row":1289,"column":0},"end":{"row":1289,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1290,"column":10},"end":{"row":1290,"column":13},"action":"insert","lines":["   "]},{"start":{"row":1290,"column":13},"end":{"row":1290,"column":14},"action":"insert","lines":[" "]},{"start":{"row":1291,"column":10},"end":{"row":1291,"column":14},"action":"insert","lines":["    "]},{"start":{"row":1292,"column":10},"end":{"row":1292,"column":12},"action":"insert","lines":["  "]},{"start":{"row":1292,"column":12},"end":{"row":1292,"column":14},"action":"insert","lines":["  "]},{"start":{"row":1293,"column":12},"end":{"row":1293,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1294,"column":12},"end":{"row":1294,"column":14},"action":"insert","lines":["  "]},{"start":{"row":1294,"column":14},"end":{"row":1294,"column":16},"action":"insert","lines":["  "]},{"start":{"row":1295,"column":0},"end":{"row":1295,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1296,"column":16},"end":{"row":1296,"column":18},"action":"insert","lines":["  "]},{"start":{"row":1296,"column":18},"end":{"row":1296,"column":20},"action":"insert","lines":["  "]},{"start":{"row":1297,"column":16},"end":{"row":1297,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1298,"column":18},"end":{"row":1298,"column":20},"action":"insert","lines":["  "]},{"start":{"row":1298,"column":20},"end":{"row":1298,"column":22},"action":"insert","lines":["  "]},{"start":{"row":1299,"column":0},"end":{"row":1299,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1300,"column":16},"end":{"row":1300,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1300,"column":17},"end":{"row":1301,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1300,"column":17},"end":{"row":1301,"column":4},"action":"insert","lines":["   }","    "]},{"start":{"row":1302,"column":12},"end":{"row":1303,"column":0},"action":"remove","lines":["} ",""]},{"start":{"row":1302,"column":12},"end":{"row":1303,"column":4},"action":"insert","lines":["    } ","    "]},{"start":{"row":1304,"column":14},"end":{"row":1304,"column":18},"action":"insert","lines":["    "]},{"start":{"row":1305,"column":12},"end":{"row":1306,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1305,"column":12},"end":{"row":1306,"column":2},"action":"insert","lines":["    }","  "]},{"start":{"row":1306,"column":12},"end":{"row":1307,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1306,"column":12},"end":{"row":1307,"column":3},"action":"insert","lines":["  }","   "]},{"start":{"row":1307,"column":13},"end":{"row":1307,"column":14},"action":"insert","lines":[" "]},{"start":{"row":1308,"column":8},"end":{"row":1309,"column":0},"action":"remove","lines":["})",""]},{"start":{"row":1308,"column":8},"end":{"row":1309,"column":4},"action":"insert","lines":["    })","    "]},{"start":{"row":1310,"column":0},"end":{"row":1310,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1311,"column":0},"end":{"row":1311,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1312,"column":0},"end":{"row":1312,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1313,"column":4},"end":{"row":1313,"column":7},"action":"insert","lines":["   "]},{"start":{"row":1313,"column":7},"end":{"row":1313,"column":8},"action":"insert","lines":[" "]},{"start":{"row":1314,"column":8},"end":{"row":1314,"column":12},"action":"insert","lines":["    "]},{"start":{"row":1315,"column":8},"end":{"row":1315,"column":10},"action":"insert","lines":["  "]},{"start":{"row":1315,"column":10},"end":{"row":1315,"column":12},"action":"insert","lines":["  "]},{"start":{"row":1316,"column":4},"end":{"row":1317,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1316,"column":4},"end":{"row":1317,"column":4},"action":"insert","lines":["    }","    "]},{"start":{"row":1318,"column":0},"end":{"row":1318,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1319,"column":2},"end":{"row":1319,"column":3},"action":"remove","lines":["}"]},{"start":{"row":1319,"column":3},"end":{"row":1321,"column":4},"action":"insert","lines":["   } ","    })","  })"]},{"start":{"row":1658,"column":94},"end":{"row":1658,"column":121},"action":"insert","lines":[",'','','','','','','','',''"]},{"start":{"row":1664,"column":84},"end":{"row":1669,"column":0},"action":"remove","lines":["2:shos,list3:sales,list4:pursums,jun:1})","})","//* 発注伝票入力・修正 *//","","//* 発注伝票削除 *//",""]},{"start":{"row":1664,"column":84},"end":{"row":1915,"column":2},"action":"insert","lines":["3:sales,list4:pursums,list5:locs,jun:1})","})","//* 発注伝票入力・修正 *//","app.post('/orderslip1', (req, res) => {","  var code = {orderslipcode:req.body.koumoku[1]}","  connection.query('SELECT * FROM ORDERTABLE WHERE ?',code,function(err,result){","    if(err){","      throw err;","    } else if(result == \"\"){","      var time = req.body.koumoku[0]","      var year = time.substr(3, 1);","      if(0 == time.substr(5,1)){","        var month = time.substr(6,1);","      } else {","        var month = time.substr(5,2);","        switch (month){","          case '10': ","            month = 'X';","            break;","          case '11':","            month = 'Y';","            break;","          case '12':","            month = 'Z';","            break;","          default:","            break;","        }","      }","      var saiban = 'B' + year + month;","      connection.query('SELECT * FROM SAIBAN WHERE saibancode = ?',saiban,function(err1,result1){","        if(err1){","          throw err1;","        } else if(result1 == \"\"){","          connection.query('INSERT INTO SAIBAN SET saibancode = ? ,count = 1',saiban,function(err2){","            if(err2){","              throw err2;","            }","          })","        } else if(result1[0].saibancode == saiban){","          connection.query('UPDATE SAIBAN SET count = count + 1 WHERE saibancode = ?',saiban,function(err2){","            if(err2){","              throw err2;","            }","          })","        }","        connection.query('SELECT count FROM SAIBAN WHERE saibancode = ?',saiban,function(err3,result3){","          if(err3){","            throw err3;","          } else {","            var orderslipcode = saiban + '-' + ('00000' + result3[0].count).slice(-5);","            var employee = {","              orderslipcode:orderslipcode,","              orderdate:req.body.koumoku[0],","              suppliercode:req.body.koumoku[6],","              remark:req.body.koumoku[9],","              deliverycode:req.body.koumoku[8],","              customercode:req.body.koumoku[3],","              sippercode:req.body.koumoku[10],","              jimucode:req.body.koumoku[13],","              staffcode:req.body.koumoku[14],","              summarycode:req.body.koumoku[15],","              flg:'20',","              staff:req.body.koumoku[12],","              contact:req.body.koumoku[16],","              ordercode:'20',","              estimatesNo:''","            }","            connection.query('INSERT INTO ORDERTABLE SET ? , additionaltime = NOW()',employee,(err4) => {","              if(err4) throw err4;","              var insertstr = ''","              for(var i = 0;req.body.table[i*19+12] != \"\";i++){","                if(i != 0){","                  insertstr += ','","                }","                insertstr +='(\"' + orderslipcode + ","                            '\",\"' + req.body.table[i*19] +","                            '\",\"' + req.body.table[i*19+1] +","                            '\",\"' + req.body.table[i*19+2] +","                            '\",\"' + String(req.body.table[i*19+5].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+4].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+6].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+12] +","                            '\",\"' + String(req.body.table[i*19+13].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+14] +","                            '\",\"' + req.body.table[i*19+3] +","                            '\",\"' + req.body.table[i*19+15] +","                            '\",\"' + req.body.table[i*19+16] +","                            '\",\"' + req.body.table[i*19+18] +","                            '\",\"' + req.body.table[i*19+10] +","                            '\",\"' + 20 + ","                            '\",\"' + String(req.body.table[i*19+7].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+8].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+17] +","                            '\")'","              }","              connection.query('INSERT INTO ORDERDETAIL(orderslipcode, number, division, productcode, quantity, purchaseprice, saleprice, productname, amount, deliverydateplans, itemname, departuredate, arrivaldate, arrivalquantity, placecode, flg, rate, logistics, deliverydate) VALUES' + insertstr,(err5) => {","                if(err5) throw err5","              })","            }) ","          }","        })","      })","    } else if(result[0].orderslipcode == req.body.koumoku[1]){","      console.log","      var employee = {","        orderdate:req.body.koumoku[0],","        suppliercode:req.body.koumoku[6],","        remark:req.body.koumoku[9],","        deliverycode:req.body.koumoku[8],","        customercode:req.body.koumoku[3],","        sippercode:req.body.koumoku[10],","        jimucode:req.body.koumoku[13],","        staffcode:req.body.koumoku[14],","        summarycode:req.body.koumoku[15],","        flg:req.body.koumoku[5],","        staff:req.body.koumoku[12],","        contact:req.body.koumoku[16],","        ordercode:req.body.koumoku[5],","        estimatesNo:''","      }","      connection.query('UPDATE ORDERTABLE SET ? , updatetime = NOW() WHERE orderslipcode = \"' + result[0].orderslipcode + '\"',employee,(err4) => {","        if(err4) throw err4","        connection.query('SELECT COUNT(*) AS cnt FROM ORDERDETAIL WHERE orderslipcode = \"' + result[0].orderslipcode + '\"',(err5,result5) => {","          if(err5) throw err5","          var cnt = 0;","          for(var i = 0; req.body.table[i*19+12] != \"\"; i++){","              cnt++","          }","          if(result5[0].cnt == cnt){","            var pur1 = \"division = CASE number \"","            var pur2 = \"productcode = CASE number \"","            var pur3 = \"productname = CASE number \"","            var pur4 = \"quantity = CASE number \"","            var pur5 = \"purchaseprice = CASE number \"","            var pur6 = \"amount = CASE number \"","            var pur7 = \"saleprice = CASE number \"","            var pur8 = \"deliverydateplans = CASE number \"","            var pur9 = \"itemname = CASE number \"","            var pur10 = \"departuredate = CASE number \"","            var pur11 = \"arrivaldate = CASE number \"","            var pur12 = \"arrivalquantity = CASE number \"","            var pur13 = \"placecode = CASE number \"","            var pur14 = \"flg = CASE number \"","            var pur15 = \"rate = CASE number \"","            var pur16 = \"logistics = CASE number \"","            var pur17 = \"deliverydate = CASE number \"","            for(var i = 0;cnt-1 >= i;i++){","              pur1 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+1] + '\" '","              pur2 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+2] + '\" '","              pur3 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+12] + '\" '","              pur4 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+5].replace(/,/g, '')) + '\" '","              pur5 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+4].replace(/,/g, '')) + '\" '","              pur6 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+13].replace(/,/g, '')) + '\" '","              pur7 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+6].replace(/,/g, '')) + '\" '","              pur8 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+14] + '\" '","              pur9 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+3] + '\" '","              pur10 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+15] + '\" '","              pur11 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+16] + '\" '","              pur12 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+18] + '\" '","              pur13 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+10] + '\" '","              pur14 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+11] + '\" '","              pur15 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+7].replace(/,/g, '')) + '\" '","              pur16 += 'WHEN ' + (i+1) + ' THEN \"' + String(req.body.table[i*19+8].replace(/,/g, '')) + '\" '","              pur17 += 'WHEN ' + (i+1) + ' THEN \"' + req.body.table[i*19+17] + '\" '","            }","              pur1 += 'END'","              pur2 += 'END'","              pur3 += 'END'","              pur4 += 'END'","              pur5 += 'END'","              pur6 += 'END'","              pur7 += 'END'","              pur8 += 'END'","              pur9 += 'END'","              pur10 += 'END'","              pur11 += 'END'","              pur12 += 'END'","              pur13 += 'END'","              pur14 += 'END'","              pur15 += 'END'","              pur16 += 'END'","              pur17 += 'END'","              connection.query('UPDATE ORDERDETAIL SET ' + pur1 + ', ' + pur2 + ', ' + pur3 + ', ' + pur4 + ', ' + pur5 + ', ' + pur6 + ', ' + pur7 + ', ' + pur8 + ', ' + pur9 + ', ' + pur10 + ', ' + pur11 + ', ' + pur12 + ', ' + pur13 + ', ' + pur14 + ', ' + pur15 + ', ' + pur16 + ', ' + pur17 +  ' WHERE orderslipcode = \"' + result[0].orderslipcode + '\"',(err6) => {","                if(err6) throw err6","              })","          } else if(result5[0].cnt < cnt || result5[0].cnt > cnt){","            var insertstr = \"\"","            connection.query('DELETE FROM ORDERDETAIL WHERE orderslipcode = \"' + req.body.koumoku[1] + '\"', (err6) => {","              if(err6) throw err6","              for(var i = 0;req.body.table[i*19+12] != \"\";i++){","                if(i != 0){","                  insertstr += ','","                }","                insertstr +='(\"' + req.body.koumoku[1] + ","                            '\",\"' + req.body.table[i*19] +","                            '\",\"' + req.body.table[i*19+1] +","                            '\",\"' + req.body.table[i*19+2] +","                            '\",\"' + String(req.body.table[i*19+5].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+4].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+6].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+12] +","                            '\",\"' + String(req.body.table[i*19+13].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+14] +","                            '\",\"' + req.body.table[i*19+3] +","                            '\",\"' + req.body.table[i*19+15] +","                            '\",\"' + req.body.table[i*19+16] +","                            '\",\"' + req.body.table[i*19+18] +","                            '\",\"' + req.body.table[i*19+10] +","                            '\",\"' + 20 + ","                            '\",\"' + String(req.body.table[i*19+7].replace(/,/g, '')) +","                            '\",\"' + String(req.body.table[i*19+8].replace(/,/g, '')) +","                            '\",\"' + req.body.table[i*19+17] +","                            '\")'","              }","              connection.query('INSERT INTO ORDERDETAIL(orderslipcode, number, division, productcode, quantity, purchaseprice, saleprice, productname, amount, deliverydateplans, itemname, departuredate, arrivaldate, arrivalquantity, placecode, flg, rate, logistics, deliverydate) VALUES' + insertstr,(err7) => {","                if(err7) throw err7","              })","            })","          } else {","            console.log('none')","          }","          if(err5) throw err5","        })","        ","      })","    }","    var koumoku = [hiduke,'','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','']","    var table =[]","    for(var i = 0;i < 8; i++){","      table.push(i+1,'','','','','','','','','','','','','','','','','','')","    }","    coded = 0","  res.render('purchase-4',{title: '発注伝票',koumoku:koumoku,table:table,list:jimus,list3:sales,list4:pursums,list5:locs,jun:1})","  })","})","//* 発注伝票削除 *//","app.post('/orderslip2', (req, res) => {","  connection.query('DELETE FROM ORDERTABLE WHERE orderslipcode = \"' + req.body.koumoku[1] + '\"', (err1) => {","    if(err1) throw err1","    connection.query('DELETE FROM ORDERDETAIL WHERE orderslipcode = \"' + req.body.koumoku[1] + '\"', (err2) => {","      if(err2) throw err2","    })","  })","  var koumoku = [hiduke,'','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','']","  var table =[]","  for(var i = 0;i < 8; i++){","    table.push(i+1,'','','','','','','','','','','','','','','','','','')","  }","  coded = 0","  res.render('purchase-4',{title: '発注伝票',koumoku:koumoku,table:table,list:jimus,list3:sales,list4:pursums,list5:locs,jun:1})","})"]},{"start":{"row":1925,"column":102},"end":{"row":1925,"column":113},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1925,"column":128},"end":{"row":1925,"column":139},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1929,"column":93},"end":{"row":1929,"column":104},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1929,"column":119},"end":{"row":1929,"column":130},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1937,"column":102},"end":{"row":1937,"column":113},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1937,"column":128},"end":{"row":1937,"column":139},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1945,"column":0},"end":{"row":1955,"column":0},"action":"insert","lines":["          var table = req.body.table","          table[6] = ''","          table[7] = ''","          table[8] = ''","          table[9] = ''","          table[10] = ''","          table[15] = ''","          table[16] = ''","          table[17] = ''","          table[18] = ''",""]},{"start":{"row":1955,"column":97},"end":{"row":1955,"column":108},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1955,"column":123},"end":{"row":1955,"column":134},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1961,"column":97},"end":{"row":1961,"column":108},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1961,"column":123},"end":{"row":1961,"column":134},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1972,"column":102},"end":{"row":1972,"column":113},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1972,"column":128},"end":{"row":1972,"column":139},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1976,"column":93},"end":{"row":1976,"column":104},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1976,"column":119},"end":{"row":1976,"column":130},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1984,"column":102},"end":{"row":1984,"column":113},"action":"remove","lines":["list2:shos,"]},{"start":{"row":1984,"column":128},"end":{"row":1984,"column":139},"action":"insert","lines":["list5:locs,"]},{"start":{"row":1988,"column":97},"end":{"row":1988,"column":102},"action":"remove","lines":["2:sho"]},{"start":{"row":1988,"column":97},"end":{"row":2039,"column":93},"action":"insert","lines":["3:sales,list4:pursums,list5:locs,jun:12})","    }","  })","})","//* 発注伝票内商品名検索 *//","app.post('/pur4-product',(req,res) => {","  var x = 0","  var flg = 0","  for(var i = 0;i < 8 && flg == 0;i++){","    if(req.body.table[2+x] != ''){","      x += 19","    } else {","      flg = 1","      var y = 2 + (i - 1) * 19","    }","  }","  var table = req.body.table","  connection.query('SELECT * FROM SHOHIN WHERE shohincode = \"' + req.body.table[y] + '\"',(err,result) => {","    if(err) throw err","    if(result != ''){","      connection.query('SELECT * FROM PRODUCTITEM WHERE productcode = \"' + req.body.table[y] + '\"',(err1,result1) => {","        if(err1) throw err1","        table[y+10] = result[0].shohinname","        table[y+1] = result1[0].itemNo","      })","    } else {","      table[y+10] = ''","      table[y+1] = ''","    }","  if(req.body.koumoku[19] == '1'){","    connection.query('SELECT * FROM RATE ORDER BY registerdate DESC',(err2,result2) => {","      if(err2) throw err2","      if(result2 != ''){","        table[y+5] = result2[0].companyrate","      } else {","        table[y+5] = ''","      }","      connection.query('SELECT * FROM PURCHASEPRICE WHERE productcode = \"' + req.body.table[y] + '\"',(err3,result3) => {","        if(err3) throw err3","        if(result3 != ''){","          table[y+6] = result3[0].logisticscostsrate","        } else {","          table[y+6] = ''","        }","        if(req.body.koumoku[6] == '2430009'){","          table[y+2] = result3[0].foreigncost1","          table[y+7] = result3[0].salescost1","        } else {","          table[y+2] = '.00'","          table[y+7] = '.00'","        }","        res.render('purchase-4',{title: '発注伝票',koumoku:req.body.koumoku,table:table,list:jimu"]},{"start":{"row":2039,"column":121},"end":{"row":2039,"column":132},"action":"insert","lines":["list5:locs,"]},{"start":{"row":2039,"column":136},"end":{"row":2039,"column":138},"action":"insert","lines":["y+"]},{"start":{"row":2040,"column":4},"end":{"row":2040,"column":5},"action":"insert","lines":[" "]},{"start":{"row":2040,"column":5},"end":{"row":2042,"column":2},"action":"remove","lines":["}","  })","})"]},{"start":{"row":2040,"column":5},"end":{"row":2055,"column":0},"action":"insert","lines":[" })","    })","  } else {","    connection.query('SELECT * FROM PURCHASEPRICE WHERE productcode = \"' + req.body.table[y] + '\"',(err4,pris) => {","      if(err4) throw err4","      if(pris != ''){","        table[y+2] = pris[0].salescost1","      } else {","        table[y+2] = ''","      }","      res.render('purchase-4',{title: '発注伝票',koumoku:req.body.koumoku,table:table,list:jimus,list3:sales,list4:pursums,list5:locs,jun:y+13})","    })","  }","})","})",""]},{"start":{"row":2056,"column":11},"end":{"row":2056,"column":14},"action":"remove","lines":["808"]},{"start":{"row":2056,"column":11},"end":{"row":2056,"column":14},"action":"insert","lines":["300"]}],[{"start":{"row":2056,"column":11},"end":{"row":2056,"column":15},"action":"remove","lines":["3000"],"id":7,"ignore":true},{"start":{"row":2056,"column":11},"end":{"row":2056,"column":15},"action":"insert","lines":["8080"]}]]},"ace":{"folds":[],"scrolltop":21748,"scrollleft":0,"selection":{"start":{"row":2056,"column":17},"end":{"row":2056,"column":17},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1671,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1597133218096,"hash":"3eb1dd2b5b485f04abf422dfe171c70705051bc5"}